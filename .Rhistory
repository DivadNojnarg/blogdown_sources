increased!",
"PO4 storage in the bone rapid pool has been
decreased!"),
Ca_fp = c("Calcium release from the bone rapid pool has been increased!",
"Calcium release from the bone rapid pool has been decreased!"),
PO4_fp = c("PO4 release from the bone rapid pool has been increased!",
"PO4 release from the bone rapid pool has been decreased!"),
Res = c("Calcium/Phosphate release from the bone
(resorption) has been increased!",
"Calcium/Phosphate release from the bone
(resorption) has been decreased!"),
GFR = c("GFR has been increased!",
"GFR has been decreased!"),
PO4_pc = c("PO4 storage into cells has been increased!",
"PO4 storage into cells has been decreased!"),
PO4_cp = c("PO4 release from cells to plasma has been
increased!",
"PO4 release from cells to plasma has been
decreased!"),
PTH_synth = c("PTH synthesis has been increased!",
"PTH synthesis has been decreased!"),
D3_synth = c("25(OH)D stock has been increased!",
"25(OH)D stock has been decreased!"),
D3_deg = c("Vitamin D3 degradation has been increased!",
"Vitamin D3 degradation has been decreased!"),
FGF_synth = c("FGF23 synthesis has been increased!",
"FGF23 synthesis has been decreased!")
),
id_edge = list(1,1,6,4,31,5,30,7,9,22,21,c(11,12,15),c(13,14,16,17),
c(13,14,16,17), c(18,19))
)
param_event
str(param_event)
lapply(param_event$id, function(x){
if (x != 1)
ifelse(x > 1,
showNotification(paste(param_event$text)),
showNotification())
edge$width[param_event$id_edge[]] <- ifelse(x == 1,
4*x,
2*x)
})
lapply(param_event$id, function(x){
if (x != 1)
ifelse(x > 1,
paste(param_event$text),
paste(param_event$text))
})
structure(1:6, dim = 2:3)
class(structure(1:6, dim = 2:3))
edge <- data.frame(width = rep(2,15))
lapply(param_event$id, function(x){
if (x != 1)
ifelse(x > 1,
#paste(param_event$text),
#paste(param_event$text))
edge$width[param_event$id_edge[]] <- ifelse(x == 1,
4*x,
2*x)
})
lapply(param_event$id, function(x){
if (x != 1)
ifelse(x > 1,
#paste(param_event$text),
#paste(param_event$text))
edge$width[param_event$id_edge] <- ifelse(x == 1,
4*x,
2*x)
})
lapply(param_event$id, function(x){
if (x != 1)
#ifelse(x > 1,
#paste(param_event$text),
#paste(param_event$text))
edge$width[param_event$id_edge] <- ifelse(x == 1,
4*x,
2*x)
})
lapply(param_event$id, function(x){
if (x != 1)
print(x)
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
})
vapply(param_event$id, function(x){
if (x != 1)
print(x), FUN.VALUE = integer(1)
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
})
vapply(param_event$id, function(x){
if (x != 1)
print(x)
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
}, , FUN.VALUE = integer(1))
vapply(param_event$id, function(x){
if (x != 1)
print(x)
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
}, FUN.VALUE = integer(1))
sapply(param_event$id, function(x){
if (x != 1)
print(x)
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
})
test  <- lapply(param_event$id, function(x){
if (x != 1)
print(x)
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
})
unlist(test)
param_event <- list(#param_id = list(input$I_Ca,input$I_P,
# input$Lambda_ac_Ca,
# input$k_p_Ca,input$k_p_P,
# input$k_f_Ca, input$k_f_P,
# c(input$Lambda_res_min,
# input$delta_res_max),
# input$GFR, input$k_pc,
# input$k_cp, input$k_prod_PTHg,
# input$D3_inact, input$k_deg_D3,
# input$k_prod_FGF),
value = c(rep(1,12),2,1,1),
text = list(Ca_intake = c("Calcium intake has been increased!",
"Calcium intake has been decreased!"),
PO4_intake = c("Phosphate intake has been increased!",
"Phosphate intake has been decreased!"),
Ca_ac = c("Calcium flux into bone has been increased!",
"Calcium flux into bone has been decreased!"),
Ca_pf = c("Calcium storage in the bone rapid pool has
been increased!",
"Calcium storage in the bone rapid pool has
been decreased!"),
PO4_pf = c("PO4 storage in the bone rapid pool has been
increased!",
"PO4 storage in the bone rapid pool has been
decreased!"),
Ca_fp = c("Calcium release from the bone rapid pool has been increased!",
"Calcium release from the bone rapid pool has been decreased!"),
PO4_fp = c("PO4 release from the bone rapid pool has been increased!",
"PO4 release from the bone rapid pool has been decreased!"),
Res = c("Calcium/Phosphate release from the bone
(resorption) has been increased!",
"Calcium/Phosphate release from the bone
(resorption) has been decreased!"),
GFR = c("GFR has been increased!",
"GFR has been decreased!"),
PO4_pc = c("PO4 storage into cells has been increased!",
"PO4 storage into cells has been decreased!"),
PO4_cp = c("PO4 release from cells to plasma has been
increased!",
"PO4 release from cells to plasma has been
decreased!"),
PTH_synth = c("PTH synthesis has been increased!",
"PTH synthesis has been decreased!"),
D3_synth = c("25(OH)D stock has been increased!",
"25(OH)D stock has been decreased!"),
D3_deg = c("Vitamin D3 degradation has been increased!",
"Vitamin D3 degradation has been decreased!"),
FGF_synth = c("FGF23 synthesis has been increased!",
"FGF23 synthesis has been decreased!")
),
id_edge = list(1,1,6,4,31,5,30,7,9,22,21,c(11,12,15),c(13,14,16,17),
c(13,14,16,17), c(18,19))
)
test  <- lapply(param_event$value, function(x){
if (x != 1)
print(x)
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
})
unlist(test)
test  <- lapply(param_event$value, function(x){
if (x != 1)
paste("An element different to 1 at", which(x != 1), "position")
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
})
unlist(test)
param_event <- list(#param_id = list(input$I_Ca,input$I_P,
# input$Lambda_ac_Ca,
# input$k_p_Ca,input$k_p_P,
# input$k_f_Ca, input$k_f_P,
# c(input$Lambda_res_min,
# input$delta_res_max),
# input$GFR, input$k_pc,
# input$k_cp, input$k_prod_PTHg,
# input$D3_inact, input$k_deg_D3,
# input$k_prod_FGF),
value = c(rep(1,12),2,1,1),
text = list(Ca_intake = c("Calcium intake has been increased!",
"Calcium intake has been decreased!"),
PO4_intake = c("Phosphate intake has been increased!",
"Phosphate intake has been decreased!"),
Ca_ac = c("Calcium flux into bone has been increased!",
"Calcium flux into bone has been decreased!"),
Ca_pf = c("Calcium storage in the bone rapid pool has
been increased!",
"Calcium storage in the bone rapid pool has
been decreased!"),
PO4_pf = c("PO4 storage in the bone rapid pool has been
increased!",
"PO4 storage in the bone rapid pool has been
decreased!"),
Ca_fp = c("Calcium release from the bone rapid pool has been increased!",
"Calcium release from the bone rapid pool has been decreased!"),
PO4_fp = c("PO4 release from the bone rapid pool has been increased!",
"PO4 release from the bone rapid pool has been decreased!"),
Res = c("Calcium/Phosphate release from the bone
(resorption) has been increased!",
"Calcium/Phosphate release from the bone
(resorption) has been decreased!"),
GFR = c("GFR has been increased!",
"GFR has been decreased!"),
PO4_pc = c("PO4 storage into cells has been increased!",
"PO4 storage into cells has been decreased!"),
PO4_cp = c("PO4 release from cells to plasma has been
increased!",
"PO4 release from cells to plasma has been
decreased!"),
PTH_synth = c("PTH synthesis has been increased!",
"PTH synthesis has been decreased!"),
D3_synth = c("25(OH)D stock has been increased!",
"25(OH)D stock has been decreased!"),
D3_deg = c("Vitamin D3 degradation has been increased!",
"Vitamin D3 degradation has been decreased!"),
FGF_synth = c("FGF23 synthesis has been increased!",
"FGF23 synthesis has been decreased!")
),
id_edge = list(1,1,6,4,31,5,30,7,9,22,21,c(11,12,15),c(13,14,16,17),
c(13,14,16,17), c(18,19))
)
edge <- data.frame(width = rep(2,15))
test  <- lapply(param_event$value, function(x){
if (x != 1)
paste("An element different to 1 at", which(x != 1), "position")
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
})
unlist(test)
which(value = c(rep(1,12),2,1,1) != 1)
which(value = c(rep(1,12),2,1,1) != 1))
which(c(rep(1,12),2,1,1) != 1)
test  <- lapply(param_event$value, function(x){
#if (x != 1)
paste("An element different to 1 at", which(x != 1), "position")
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
})
unlist(test)
test  <- lapply(param_event$value, function(x){
#if (x != 1)
print(which(x != 1))
#edge$width[param_event$id_edge] <- ifelse(x == 1,
#                                          4*x,
#                                          2*x)
})
event_id <- (which(x != 1))
event_id <- (which(param_event$value != 1))
event_id
edge$width[param_event$id_edge[event_id]] <- ifelse(x == 1,4*value[event_id],2*value[event_id])
edge$width[param_event$id_edge[event_id]] <- 4*param_event$value[event_id]
param_event$value[event_id]
4*param_event$value[event_id]
param_event$id_edge[event_id]
edge$width[event_id] <- 4*param_event$value[event_id]
edge
edge$width[event_id] <- ielse(param_event$value[event_id] >1,
4*param_event$value[event_id],
2*param_event$value[event_id])
edge$width[event_id] <- ifelse(param_event$value[event_id] >1,
4*param_event$value[event_id],
2*param_event$value[event_id])
edge
arrow_lighting <- function(events) {
param_event <- list(
value = c(rep(1,12),2,1,1),
text = list(Ca_intake = c("Calcium intake has been increased!",
"Calcium intake has been decreased!"),
PO4_intake = c("Phosphate intake has been increased!",
"Phosphate intake has been decreased!"),
Ca_ac = c("Calcium flux into bone has been increased!",
"Calcium flux into bone has been decreased!"),
Ca_pf = c("Calcium storage in the bone rapid pool has
been increased!",
"Calcium storage in the bone rapid pool has
been decreased!"),
PO4_pf = c("PO4 storage in the bone rapid pool has been
increased!",
"PO4 storage in the bone rapid pool has been
decreased!"),
Ca_fp = c("Calcium release from the bone rapid pool has been increased!",
"Calcium release from the bone rapid pool has been decreased!"),
PO4_fp = c("PO4 release from the bone rapid pool has been increased!",
"PO4 release from the bone rapid pool has been decreased!"),
Res = c("Calcium/Phosphate release from the bone
(resorption) has been increased!",
"Calcium/Phosphate release from the bone
(resorption) has been decreased!"),
GFR = c("GFR has been increased!",
"GFR has been decreased!"),
PO4_pc = c("PO4 storage into cells has been increased!",
"PO4 storage into cells has been decreased!"),
PO4_cp = c("PO4 release from cells to plasma has been
increased!",
"PO4 release from cells to plasma has been
decreased!"),
PTH_synth = c("PTH synthesis has been increased!",
"PTH synthesis has been decreased!"),
D3_synth = c("25(OH)D stock has been increased!",
"25(OH)D stock has been decreased!"),
D3_deg = c("Vitamin D3 degradation has been increased!",
"Vitamin D3 degradation has been decreased!"),
FGF_synth = c("FGF23 synthesis has been increased!",
"FGF23 synthesis has been decreased!")
),
id_edge = list(1,1,6,4,31,5,30,7,9,22,21,c(11,12,15),c(13,14,16,17),
c(13,14,16,17), c(18,19))
)
event_id <- (which(param_event$value != 1))
edge$width[event_id] <- ifelse(param_event$value[event_id] >1,
4*param_event$value[event_id],
2*param_event$value[event_id])
}
events <- c(rep(1,12),2,1,1)
arrow_lighting(events = )
arrow_lighting(events )
arrow_lighting(events)
edge <- data.frame(width = rep(2,15))
edge
events <- c(rep(1,12),2,1,1)
arrow_lighting <- function(events) {
param_event <- list(
value = events,
text = list(Ca_intake = c("Calcium intake has been increased!",
"Calcium intake has been decreased!"),
PO4_intake = c("Phosphate intake has been increased!",
"Phosphate intake has been decreased!"),
Ca_ac = c("Calcium flux into bone has been increased!",
"Calcium flux into bone has been decreased!"),
Ca_pf = c("Calcium storage in the bone rapid pool has
been increased!",
"Calcium storage in the bone rapid pool has
been decreased!"),
PO4_pf = c("PO4 storage in the bone rapid pool has been
increased!",
"PO4 storage in the bone rapid pool has been
decreased!"),
Ca_fp = c("Calcium release from the bone rapid pool has been increased!",
"Calcium release from the bone rapid pool has been decreased!"),
PO4_fp = c("PO4 release from the bone rapid pool has been increased!",
"PO4 release from the bone rapid pool has been decreased!"),
Res = c("Calcium/Phosphate release from the bone
(resorption) has been increased!",
"Calcium/Phosphate release from the bone
(resorption) has been decreased!"),
GFR = c("GFR has been increased!",
"GFR has been decreased!"),
PO4_pc = c("PO4 storage into cells has been increased!",
"PO4 storage into cells has been decreased!"),
PO4_cp = c("PO4 release from cells to plasma has been
increased!",
"PO4 release from cells to plasma has been
decreased!"),
PTH_synth = c("PTH synthesis has been increased!",
"PTH synthesis has been decreased!"),
D3_synth = c("25(OH)D stock has been increased!",
"25(OH)D stock has been decreased!"),
D3_deg = c("Vitamin D3 degradation has been increased!",
"Vitamin D3 degradation has been decreased!"),
FGF_synth = c("FGF23 synthesis has been increased!",
"FGF23 synthesis has been decreased!")
),
id_edge = list(1,1,6,4,31,5,30,7,9,22,21,c(11,12,15),c(13,14,16,17),
c(13,14,16,17), c(18,19))
)
event_id <- (which(param_event$value != 1))
edge$width[event_id] <- ifelse(param_event$value[event_id] >1,
4*param_event$value[event_id],
2*param_event$value[event_id])
}
events
edge <- data.frame(width = rep(2,15))
edge
arrow_lighting(events)
edge
vec <- c(rep(1,12),2,1,1)
arrow_lighting <- function(events) {
param_event <- list(
value = events,
text = list(Ca_intake = c("Calcium intake has been increased!",
"Calcium intake has been decreased!"),
PO4_intake = c("Phosphate intake has been increased!",
"Phosphate intake has been decreased!"),
Ca_ac = c("Calcium flux into bone has been increased!",
"Calcium flux into bone has been decreased!"),
Ca_pf = c("Calcium storage in the bone rapid pool has
been increased!",
"Calcium storage in the bone rapid pool has
been decreased!"),
PO4_pf = c("PO4 storage in the bone rapid pool has been
increased!",
"PO4 storage in the bone rapid pool has been
decreased!"),
Ca_fp = c("Calcium release from the bone rapid pool has been increased!",
"Calcium release from the bone rapid pool has been decreased!"),
PO4_fp = c("PO4 release from the bone rapid pool has been increased!",
"PO4 release from the bone rapid pool has been decreased!"),
Res = c("Calcium/Phosphate release from the bone
(resorption) has been increased!",
"Calcium/Phosphate release from the bone
(resorption) has been decreased!"),
GFR = c("GFR has been increased!",
"GFR has been decreased!"),
PO4_pc = c("PO4 storage into cells has been increased!",
"PO4 storage into cells has been decreased!"),
PO4_cp = c("PO4 release from cells to plasma has been
increased!",
"PO4 release from cells to plasma has been
decreased!"),
PTH_synth = c("PTH synthesis has been increased!",
"PTH synthesis has been decreased!"),
D3_synth = c("25(OH)D stock has been increased!",
"25(OH)D stock has been decreased!"),
D3_deg = c("Vitamin D3 degradation has been increased!",
"Vitamin D3 degradation has been decreased!"),
FGF_synth = c("FGF23 synthesis has been increased!",
"FGF23 synthesis has been decreased!")
),
id_edge = list(1,1,6,4,31,5,30,7,9,22,21,c(11,12,15),c(13,14,16,17),
c(13,14,16,17), c(18,19))
)
event_id <- (which(param_event$value != 1))
edge$width[event_id] <- ifelse(param_event$value[event_id] > 1,
4*param_event$value[event_id],
2*param_event$value[event_id])
}
arrow_lighting(vec)
edge <- data.frame(width = rep(2,15))
arrow_lighting(vec)
edge
arrow_lighting <- function(events) {
param_event <- list(
value = events,
text = list(Ca_intake = c("Calcium intake has been increased!",
"Calcium intake has been decreased!"),
PO4_intake = c("Phosphate intake has been increased!",
"Phosphate intake has been decreased!"),
Ca_ac = c("Calcium flux into bone has been increased!",
"Calcium flux into bone has been decreased!"),
Ca_pf = c("Calcium storage in the bone rapid pool has
been increased!",
"Calcium storage in the bone rapid pool has
been decreased!"),
PO4_pf = c("PO4 storage in the bone rapid pool has been
increased!",
"PO4 storage in the bone rapid pool has been
decreased!"),
Ca_fp = c("Calcium release from the bone rapid pool has been increased!",
"Calcium release from the bone rapid pool has been decreased!"),
PO4_fp = c("PO4 release from the bone rapid pool has been increased!",
"PO4 release from the bone rapid pool has been decreased!"),
Res = c("Calcium/Phosphate release from the bone
(resorption) has been increased!",
"Calcium/Phosphate release from the bone
(resorption) has been decreased!"),
GFR = c("GFR has been increased!",
"GFR has been decreased!"),
PO4_pc = c("PO4 storage into cells has been increased!",
"PO4 storage into cells has been decreased!"),
PO4_cp = c("PO4 release from cells to plasma has been
increased!",
"PO4 release from cells to plasma has been
decreased!"),
PTH_synth = c("PTH synthesis has been increased!",
"PTH synthesis has been decreased!"),
D3_synth = c("25(OH)D stock has been increased!",
"25(OH)D stock has been decreased!"),
D3_deg = c("Vitamin D3 degradation has been increased!",
"Vitamin D3 degradation has been decreased!"),
FGF_synth = c("FGF23 synthesis has been increased!",
"FGF23 synthesis has been decreased!")
),
id_edge = list(1,1,6,4,31,5,30,7,9,22,21,c(11,12,15),c(13,14,16,17),
c(13,14,16,17), c(18,19))
)
event_id <- (which(param_event$value != 1))
edge$width[event_id] <- ifelse(param_event$value[event_id] > 1,
4*param_event$value[event_id],
2*param_event$value[event_id])
return(event_id)
}
arrow_lighting(vec)
setwd("~/Documents/blogdown_sources/content")
blogdown::build_site()
setwd("~/Documents/blogdown_sources")
blogdown::build_site()
blogdown::build_site()
blogdown::serve_site()
